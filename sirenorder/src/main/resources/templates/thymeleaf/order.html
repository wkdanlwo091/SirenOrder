<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Insert title here</title>
</head>

<!-- 체인점 검색, 매장 검색 하는 페이지 by javascript -->
<body>
	<form id = "toOrderPageId" action = "product.html"><!--  -->
		<input type='hidden' name='chain_name' value='hidden' />
		<input type='hidden' name='store_name' value='hidden' />
	</form>
<script>
	var tmp;
	function getProduct(chain_name, store_name){//체인의 상점의 물품을 가져오기 위해서 form 태그로 서버에 보낸다. 
    	document.querySelector("#toOrderPageId > input[type=hidden]:nth-child(1)").value = chain_name;//chain_name
    	document.querySelector("#toOrderPageId > input[type=hidden]:nth-child(2)").value = store_name;//store_name
    	document.getElementById("toOrderPageId").submit();
	}
</script>
	<div class="input-group" style = "width:50%">
		<input id = "searchStoreId" type="text" value="" class="form-control" placeholder="매장검색(체인명)">
		<span class="input-group-btn">
			<button id="searchId" type="button" class="btn btn-primary">
				Go
			</button>
			
		</span>
	</div>
	<div class="input-group" style = "width:50%">
		<div style = "float: right;">
			<label for="cars" >정렬 옵션 : </label>
				  <select name="sort" id="sortOptionId">
				    <option value="none">미 선택</option>
				    <option value="location">가장 가까운곳</option>
			</select>
		</div>
	</div>
		<div .table-responsive style = "width:50%">
	  		<table border="1" class = "table table-bordered table-hover" >
				<th>매장명</th>
	    	</table>
		</div>
		
	<script>
	$("#searchId").on("click", function(){
		
		var e = document.getElementById("sortOptionId");
		
		var option = e.options[e.selectedIndex].value;
		data = "chain=" + $('#searchStoreId').val().toLowerCase() +
		" &option=" + option +"&latitude=" + sessionStorage.lat + "&longtitude=" + sessionStorage.longti;
		
		$.ajax({
            url: "searchStore",
            type: "POST",
            data: data,
            dataType: "json",
            success: function(data){
            	$('th').empty();
                for(var i=0; i<data.length; i++){
                	//<button type="button" onclick="alert('Hello world!')">Click Me!</button>
                	$('th').append("<tr><td> <button class=\"btn btn-primary\" class=\"block\" style=\"width:100%\" type=\"button\" onclick=\"getProduct(" +  "'"  + data[i].chain_name + "','"+ data[i].store_name + "'"   +")\">"+ data[i].store_name + "</button> </td></tr>");
                }
                console.log(data[0]);
            },
            error: function(data){
            	alert("찾으시는 체인이 없습니다.");
            }
        });
	});
	</script>
</body>
</html>