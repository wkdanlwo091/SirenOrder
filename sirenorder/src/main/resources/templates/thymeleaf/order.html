<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Insert title here</title>
</head>


<!-- 체인점 검색, 매장 검색 하는 페이지 by javascript -->
<body>
	<form id = "toOrderPageId" action = "product.html"><!--  -->
		<input type='hidden' name='chain_name' value='hidden' />
		<input type='hidden' name='store_name' value='hidden' />
	</form>
<script>

	var lat;
	var longti;
	
	function getLocation() {
	  if (navigator.geolocation) {
	    navigator.geolocation.getCurrentPosition(showPosition);
	  } else { 
	    alert("현재 브라우져에서는 위치 지원이 안됩니다.");
	  }
	}

	function showPosition(position) {
		 lat = position.coords.latitude; 
		 longti = position.coords.longitude;
		$(".nav.navbar-nav.navbar-left").text( "위도 : " + lat + "경도 : " + longti);
		
		
		//여기서 서버에 위도 경도 보내준다 
	}

	$(function (){
		//gps로 내 위치 설정하기 
		if (confirm('gps로 현재 위치 설정 하시겠습니까?')) {
			//gps 설정
			getLocation();
			
		} else {
			  // Do nothing!
		}
	});
	
	var tmp;
	function getProduct(chain_name, store_name){//체인의 상점의 물품을 가져오기 위해서 form 태그로 서버에 보낸다. 
    	document.querySelector("#toOrderPageId > input[type=hidden]:nth-child(1)").value = chain_name;//chain_name
    	document.querySelector("#toOrderPageId > input[type=hidden]:nth-child(2)").value = store_name;//store_name
    	document.getElementById("toOrderPageId").submit();
	}
	
	</script>
	<div class="input-group" style = "width:50%">
		<input id = "searchStoreId" type="text" value="" class="form-control" placeholder="매장검색(체인명)">
		<span class="input-group-btn"><button id="searchId" type="button" class="btn btn-primary">Go</button></span>
	</div>
		<div .table-responsive style = "width:50%">
	  		<table border="1" class = "table table-bordered table-hover" >
				<th>매장명</th>
	    	</table>
		</div>
	<script>

	$(function(){
		
		
	});
	$("#searchId").on("click", function(){
		data = "chain=" + $('#searchStoreId').val().toLowerCase();
		$.ajax({
            url: "searchStore",
            type: "POST",
            data: data,
            dataType: "json",
            success: function(data){
            	$('th').empty();
                for(var i=0; i<data.length; i++){
                	//<button type="button" onclick="alert('Hello world!')">Click Me!</button>
                	$('th').append("<tr><td> <button class=\"btn btn-primary\" class=\"block\" style=\"width:100%\" type=\"button\" onclick=\"getProduct(" +  "'"  + data[i].chain_name + "','"+ data[i].store_name + "'"   +")\">"+ data[i].store_name + "</button> </td></tr>");
                }
                console.log(data[0]);
            },
            error: function(data){
            	alert("찾으시는 체인이 없습니다.");
            }
        });
	});
	</script>
</body>
</html>