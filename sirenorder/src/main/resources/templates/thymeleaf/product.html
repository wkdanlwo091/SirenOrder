<!doctype html>
<html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <title></title>
    <!-- animate CSS -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <!-- nice select CSS -->
    <link rel="stylesheet" href="css/nice-select.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="css/all.css">
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="css/magnific-popup.css">
    <!-- swiper CSS -->
    <link rel="stylesheet" href="css/slick.css">
    <!-- style CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<script>

	var totalNum = 0;
	function addToCart(product_name, price){
		data = "product_name=" + product_name + "&price=" + price + "&sign=plus";
		$.ajax({//세션 만들어서 return 한다. 
			  url: "cartProduct",
			  method: "POST", 
			  data : data,
			  success: function(result){
				var array = JSON.parse(result);
				var number = array[0]["number"];
				var numOfArrays = array.length;
				var totalPrice = 0;
				console.log(array.length);
				console.log("kaka" + JSON.parse(result)[0]["price"]);
				console.log("haha" + array[0]["product_name"]);
				console.log("jaja" + array[0]["number"]);
			  	var cartHistory = document.getElementById("cartList");
			  	document.getElementById("cartList").innerHTML = '<p>haha</p>';
				for(var i in array){//iteration을 한다. 
				  	var tmp = "<li><a href=\"#\" class=\"notification-item\">";
					tmp += array[i]["product_name"] + " "+ array[i]["number"] + "개 "+ array[i]["price"]*array[i]["number"] + "원 " +"</a></li>";
				  	cartHistory.insertAdjacentHTML('afterbegin', tmp);
				  	totalPrice += array[i]["price"] * array[i]["number"];
				}
				cartHistory.insertAdjacentHTML('afterbegin', "<li><a href=\"/checkOut.html\" class=\"more\">총가격 : " + totalPrice + " 장바구니 계산하기</a></li>");
			  },
	            error: function(result){
	            	alert("error 는" + result);
	            }
		});
	}
	function minusToCart(product_name, price){
		data = "product_name=" + product_name + "&price=" + price + "&sign=minus";
		$.ajax({//세션 만들어서 return 한다. 
			  url: "cartProduct",
			  method: "POST", 
			  data : data,
			  dataType : 'json', 
			  success: function(result){
			  	if(result == "noData"){
			  		alert("이미 수량이 0입니다.");
			  	}else{
					console.log("실패 returned 된 value는 " + result +  result.toString());
			  	}
			  },
	          error: function(result){
	          }
		});
}
$(function(){//페이지 로드되면 ajax를 이용해서  장바구니 정보 가져온다. 세션 필요 없다?

});

	//#navbar-menu > ul > li:nth-child(1) > a > span              -----> 이는 장바구니 갯수를 나타낸다. 
</script>
<body>
    <!--================Category Product Area =================-->
        <div class="container">
            <div class="row">
                <div class="col-lg-9">
                    <div class="row align-items-center latest_product_inner">
                    
                        <!--  
						<tr th:each="data, iterstat: ${mois}">
						     <td th:text="${data}" th:id="|td${iterstat.index}|"></td>
						</tr>
						
						<tr th:each="prod : ${prods}">
					        <td th:text="${prod.name}">Onions</td>
					        <td th:text="${prod.price}">2.41</td>
					        <td th:text="${prod.inStock}? #{true} : #{false}">yes</td>
					    </tr>	
									-->		
                        <div class="col-lg-4 col-sm-6" th:each="list : ${List}">
                            <div class="single_product_item">
                                <img th:src="${list.image}" alt="">
                                <div class="single_product_text">
                                    <h4 th:text="${list.product_name}"></h4>
                                    <h3 th:text="${list.price}"></h3>
                                    <a href="#"  th:attr="onclick=|addToCart('${list.product_name}', '${list.price}')|" class="add_cart">+ 물건 담기</a>
                                    <a href="#"  th:attr="onclick=|minusToCart('${list.product_name}', '${list.price}')|" class="add_cart">- 물건 빼기</a>
                                </div><!-- th:attr="onclick=|upload('${gallery}')|"  -->
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="pageination">
                                <nav aria-label="Page navigation example">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Previous">
                                                <i class="ti-angle-double-left"></i>
                                            </a>
                                        </li>
                                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item"><a class="page-link" href="#">4</a></li>
                                        <li class="page-item"><a class="page-link" href="#">5</a></li>
                                        <li class="page-item"><a class="page-link" href="#">6</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Next">
                                                <i class="ti-angle-double-right"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <!-- jquery plugins here-->
    <script src="js/jquery-1.12.1.min.js"></script>
    <!-- popper js -->
    <script src="js/popper.min.js"></script>
    <!-- bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- easing js -->
    <script src="js/jquery.magnific-popup.js"></script>
    <!-- swiper js -->
    <script src="js/swiper.min.js"></script>
    <!-- swiper js -->
    <script src="js/masonry.pkgd.js"></script>
    <!-- particles js -->
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <!-- slick js -->
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>
    <script src="js/stellar.js"></script>
    <script src="js/price_rangs.js"></script>
    <!-- custom js -->
    <script src="js/custom.js"></script>
</body>

</html>